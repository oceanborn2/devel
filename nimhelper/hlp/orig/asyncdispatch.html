<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nimrod. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>

<!-- Google fonts -->
<link href='http://fonts.googleapis.com/css?family=Raleway:400,600,900' rel='stylesheet' type='text/css'/>
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>Module asyncdispatch</title>
<style type="text/css" >
/*
Stylesheet for use with Docutils/rst2html.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.

Modified from Chad Skeeters' rst2html-style
https://bitbucket.org/cskeeters/rst2html-style/

Modified by Boyd Greenfield
*/
/* SCSS variables */
/* Text weights */
/* Body colors */
/* Text colors */
/* Link colors */
/* Syntax highlighting colors */
/* Pct changes */
/* Mixins */
/* Body/layout */
html {
  font-size: 100%;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%; }

/* Where we want fancier font if available */
h1, h2, h3, h4, h5, h6, p.module-desc, table.docinfo + blockquote p, table.docinfo blockquote p, h1 + blockquote p {
  font-family: "Raleway", "Helvetica Neue", "HelveticaNeue", Helvetica, Arial, sans-serif !important; }

h1.title {
  font-weight: 900; }

body {
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif;
  font-weight: 400;
  font-size: 14px;
  line-height: 20px;
  color: #666;
  background-color: rgba(252, 248, 244, 0.75); }

/* Skeleton grid */
.container {
  position: relative;
  width: 100%;
  max-width: 960px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box; }

.column,
.columns {
  width: 100%;
  float: left;
  box-sizing: border-box; }

/* For devices larger than 400px */
@media (min-width: 400px) {
  .container {
    width: 100%;
    padding: 0; } }
/* For devices larger than 650px */
@media (min-width: 650px) {
  .container {
    width: 100%; }

  .column,
  .columns {
    margin-left: 4%; }

  .column:first-child,
  .columns:first-child {
    margin-left: 0; }

  .one.column,
  .one.columns {
    width: 4.66666666667%; }

  .two.columns {
    width: 13.3333333333%; }

  .three.columns {
    width: 22%; }

  .four.columns {
    width: 30.6666666667%; }

  .five.columns {
    width: 39.3333333333%; }

  .six.columns {
    width: 48%; }

  .seven.columns {
    width: 56.6666666667%; }

  .eight.columns {
    width: 65.3333333333%; }

  .nine.columns {
    width: 74.0%; }

  .ten.columns {
    width: 82.6666666667%; }

  .eleven.columns {
    width: 91.3333333333%; }

  .twelve.columns {
    width: 100%;
    margin-left: 0; }

  .one-third.column {
    width: 30.6666666667%; }

  .two-thirds.column {
    width: 65.3333333333%; } }
/* Customer Overrides */
.footer {
  text-align: center;
  color: #969696;
  padding-top: 10%; }

p.module-desc {
  font-size: 1.1em;
  color: #666666; }

a.link-seesrc {
  color: #aec7d2;
  font-style: italic; }

a.link-seesrc:hover {
  color: #6c9aae; }

#toc-list {
  word-wrap: break-word; }

ul.simple-toc {
  list-style: none; }

ul.simple-toc a.reference-toplevel {
  font-weight: bold;
  color: #0077b3; }

ul.simple-toc-section {
  list-style-type: circle;
  color: #6c9aae; }

ul.simple-toc-section a.reference {
  color: #0077b3; }

cite {
  font-style: italic !important; }

dt > pre {
  border-color: rgba(0, 0, 0, 0.15);
  background-color: transparent;
  margin: 15px 0px 5px; }

dd > pre {
  border-color: rgba(0, 0, 0, 0.1);
  background-color: whitesmoke;
  margin-top: 8px; }

.item > dd {
  margin-left: 10px;
  margin-bottom: 30px; }

/* Nim line-numbered tables */
.line-nums-table {
  width: 100%;
  table-layout: fixed; }

table.line-nums-table {
  border-radius: 4px;
  border: 1px solid #cccccc;
  background-color: whitesmoke;
  border-collapse: separate;
  margin-top: 15px;
  margin-bottom: 25px; }

.line-nums-table tbody {
  border: none; }

.line-nums-table td pre {
  border: none;
  background-color: transparent; }

.line-nums-table td.blob-line-nums {
  width: 28px; }

.line-nums-table td.blob-line-nums pre {
  color: #b0b0b0;
  -webkit-filter: opacity(75%);
  text-align: right;
  border-color: transparent;
  background-color: transparent;
  padding-left: 0px;
  margin-left: 0px;
  padding-right: 0px;
  margin-right: 0px; }

/* Docgen styles */
/* Links */
a {
  color: #0077b3;
  text-decoration: none; }

a:hover,
a:focus {
  color: #00334d;
  text-decoration: underline; }

a:visited {
  color: #00334d; }

a:focus {
  outline: thin dotted #2d2d2d;
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px; }

a:hover,
a:active {
  outline: 0; }

sub,
sup {
  position: relative;
  font-size: 75%;
  line-height: 0;
  vertical-align: baseline; }

sup {
  top: -0.5em; }

sub {
  bottom: -0.25em; }

img {
  width: auto;
  height: auto;
  max-width: 100%;
  vertical-align: middle;
  border: 0;
  -ms-interpolation-mode: bicubic; }

@media print {
  * {
    color: black !important;
    text-shadow: none !important;
    background: transparent !important;
    box-shadow: none !important; }

  a,
  a:visited {
    text-decoration: underline; }

  a[href]:after {
    content: " (" attr(href) ")"; }

  abbr[title]:after {
    content: " (" attr(title) ")"; }

  .ir a:after,
  a[href^="javascript:"]:after,
  a[href^="#"]:after {
    content: ""; }

  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid; }

  thead {
    display: table-header-group; }

  tr,
  img {
    page-break-inside: avoid; }

  img {
    max-width: 100% !important; }

  @page {
    margin: 0.5cm; }

  h1 {
    page-break-before: always; }

  h1.title {
    page-break-before: avoid; }

  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3; }

  h2,
  h3 {
    page-break-after: avoid; } }
.img-rounded {
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px; }

.img-polaroid {
  padding: 4px;
  background-color: rgba(252, 248, 244, 0.75);
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); }

p {
  margin: 0 0 12px; }

small {
  font-size: 85%; }

strong {
  font-weight: 600; }

em {
  font-style: italic; }

cite {
  font-style: normal; }

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif;
  font-weight: 600;
  line-height: 20px;
  color: inherit;
  text-rendering: optimizelegibility; }

h1 {
  font-size: 2em;
  padding-bottom: .15em;
  border-bottom: 1px solid #aaaaaa;
  margin-top: 1.0em;
  line-height: 1.2em; }

h1.title {
  padding-bottom: 1em;
  border-bottom: 0px;
  font-size: 2.75em; }

h2 {
  font-size: 1.5em;
  margin-top: 1.5em; }

h3 {
  font-size: 1.3em;
  font-style: italic;
  margin-top: 0.75em; }

h4 {
  font-size: 1.3em;
  margin-top: 0.5em; }

h5 {
  font-size: 1.2em;
  margin-top: 0.25em; }

h6 {
  font-size: 1.1em; }

ul,
ol {
  padding: 0;
  margin: 0 0 0px 15px; }

ul ul,
ul ol,
ol ol,
ol ul {
  margin-bottom: 0; }

li {
  line-height: 20px; }

dl {
  margin-bottom: 20px; }

dt,
dd {
  line-height: 20px; }

dt {
  font-weight: bold; }

dd {
  margin-left: 10px;
  margin-bottom: 26px; }

hr {
  margin: 20px 0;
  border: 0;
  border-top: 1px solid #eeeeee;
  border-bottom: 1px solid #ffffff; }

abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #999999; }

abbr.initialism {
  font-size: 90%;
  text-transform: uppercase; }

blockquote {
  padding: 0 0 0 15px;
  margin: 0 0 20px;
  border-left: 5px solid #EFEBE0; }

table.docinfo + blockquote, table.docinfo blockquote, h1 + blockquote {
  border-left: 5px solid #c9c9c9;
}

table.docinfo + blockquote p, table.docinfo blockquote p, h1 + blockquote p {
  margin-bottom: 0;
  font-size: 15px;
  font-weight: 200;
  line-height: 1.5;
  font-style: italic; }

q:before,
q:after,
blockquote:before,
blockquote:after {
  content: ""; }

address {
  display: block;
  margin-bottom: 20px;
  font-style: normal;
  line-height: 20px; }

code,
pre {
  font-family: "Source Code Pro", Monaco, Menlo, Consolas, "Courier New", monospace;
  padding: 0 3px 2px;
  font-weight: 500;
  font-size: 12px;
  color: #444444;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px; }

.pre {
  font-family: "Source Code Pro", Monaco, Menlo, Consolas, "Courier New", monospace;
  font-weight: 600;
  /*color: #504da6;*/
}

code {
  padding: 2px 4px;
  color: #444444;
  white-space: nowrap;
  background-color: white;
  border: 1px solid #777777; }

pre {
  display: inline-block;
  box-sizing: border-box;
  min-width: calc(100% - 19.5px);
  padding: 9.5px;
  margin: 0.25em 10px 0.25em 10px;
  font-size: 14px;
  line-height: 20px;
  white-space: pre !important;
  overflow-y: hidden;
  overflow-x: visible;
  background-color: whitesmoke;
  border: 1px solid #cccccc;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px; }

pre.prettyprint {
  margin-bottom: 20px; }

pre code {
  padding: 0;
  color: inherit;
  white-space: pre;
  overflow-x: visible;
  background-color: transparent;
  border: 0; }

.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll; }

table {
  max-width: 100%;
  background-color: transparent;
  border-collapse: collapse;
  border-spacing: 0; }

table th, table td {
  padding: 0px 8px 0px;
}

.table {
  width: 100%;
  margin-bottom: 20px; }

.table th,
.table td {
  padding: 8px;
  line-height: 20px;
  text-align: left;
  vertical-align: top;
  border-top: 1px solid #444444; }

.table th {
  font-weight: bold; }

.table thead th {
  vertical-align: bottom; }

.table caption + thead tr:first-child th,
.table caption + thead tr:first-child td,
.table colgroup + thead tr:first-child th,
.table colgroup + thead tr:first-child td,
.table thead:first-child tr:first-child th,
.table thead:first-child tr:first-child td {
  border-top: 0; }

.table tbody + tbody {
  border-top: 2px solid #444444; }

.table .table {
  background-color: rgba(252, 248, 244, 0.75); }

.table-condensed th,
.table-condensed td {
  padding: 4px 5px; }

.table-bordered {
  border: 1px solid #444444;
  border-collapse: separate;
  *border-collapse: collapse;
  border-left: 0;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px; }

.table-bordered th,
.table-bordered td {
  border-left: 1px solid #444444; }

.table-bordered caption + thead tr:first-child th,
.table-bordered caption + tbody tr:first-child th,
.table-bordered caption + tbody tr:first-child td,
.table-bordered colgroup + thead tr:first-child th,
.table-bordered colgroup + tbody tr:first-child th,
.table-bordered colgroup + tbody tr:first-child td,
.table-bordered thead:first-child tr:first-child th,
.table-bordered tbody:first-child tr:first-child th,
.table-bordered tbody:first-child tr:first-child td {
  border-top: 0; }

.table-bordered thead:first-child tr:first-child > th:first-child,
.table-bordered tbody:first-child tr:first-child > td:first-child,
.table-bordered tbody:first-child tr:first-child > th:first-child {
  -webkit-border-top-left-radius: 4px;
  border-top-left-radius: 4px;
  -moz-border-radius-topleft: 4px; }

.table-bordered thead:first-child tr:first-child > th:last-child,
.table-bordered tbody:first-child tr:first-child > td:last-child,
.table-bordered tbody:first-child tr:first-child > th:last-child {
  -webkit-border-top-right-radius: 4px;
  border-top-right-radius: 4px;
  -moz-border-radius-topright: 4px; }

.table-bordered thead:last-child tr:last-child > th:first-child,
.table-bordered tbody:last-child tr:last-child > td:first-child,
.table-bordered tbody:last-child tr:last-child > th:first-child,
.table-bordered tfoot:last-child tr:last-child > td:first-child,
.table-bordered tfoot:last-child tr:last-child > th:first-child {
  -webkit-border-bottom-left-radius: 4px;
  border-bottom-left-radius: 4px;
  -moz-border-radius-bottomleft: 4px; }

.table-bordered thead:last-child tr:last-child > th:last-child,
.table-bordered tbody:last-child tr:last-child > td:last-child,
.table-bordered tbody:last-child tr:last-child > th:last-child,
.table-bordered tfoot:last-child tr:last-child > td:last-child,
.table-bordered tfoot:last-child tr:last-child > th:last-child {
  -webkit-border-bottom-right-radius: 4px;
  border-bottom-right-radius: 4px;
  -moz-border-radius-bottomright: 4px; }

.table-bordered tfoot + tbody:last-child tr:last-child td:first-child {
  -webkit-border-bottom-left-radius: 0;
  border-bottom-left-radius: 0;
  -moz-border-radius-bottomleft: 0; }

.table-bordered tfoot + tbody:last-child tr:last-child td:last-child {
  -webkit-border-bottom-right-radius: 0;
  border-bottom-right-radius: 0;
  -moz-border-radius-bottomright: 0; }

.table-bordered caption + thead tr:first-child th:first-child,
.table-bordered caption + tbody tr:first-child td:first-child,
.table-bordered colgroup + thead tr:first-child th:first-child,
.table-bordered colgroup + tbody tr:first-child td:first-child {
  -webkit-border-top-left-radius: 4px;
  border-top-left-radius: 4px;
  -moz-border-radius-topleft: 4px; }

.table-bordered caption + thead tr:first-child th:last-child,
.table-bordered caption + tbody tr:first-child td:last-child,
.table-bordered colgroup + thead tr:first-child th:last-child,
.table-bordered colgroup + tbody tr:first-child td:last-child {
  -webkit-border-top-right-radius: 4px;
  border-top-right-radius: 4px;
  -moz-border-radius-topright: 4px; }

table.docutils th {
  background-color: #e8e8e8; }

table.docutils tr:hover {
  background-color: whitesmoke; }

.table-striped tbody > tr:nth-child(odd) > td,
.table-striped tbody > tr:nth-child(odd) > th {
  background-color: rgba(252, 248, 244, 0.75); }

.table-hover tbody tr:hover > td,
.table-hover tbody tr:hover > th {
  background-color: rgba(241, 222, 204, 0.75); }

table td[class*="span"],
table th[class*="span"],
.row-fluid table td[class*="span"],
.row-fluid table th[class*="span"] {
  display: table-cell;
  float: none;
  margin-left: 0; }

.hero-unit {
  padding: 60px;
  margin-bottom: 30px;
  font-size: 18px;
  font-weight: 200;
  line-height: 30px;
  color: inherit;
  background-color: rgba(230, 197, 164, 0.75);
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px; }

.hero-unit h1 {
  margin-bottom: 0;
  font-size: 60px;
  line-height: 1;
  letter-spacing: -1px;
  color: inherit; }

.hero-unit li {
  line-height: 30px; }

/* rst2html default used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0; }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 !important; }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 !important; }

.last, .with-subtitle {
  margin-bottom: 0 !important; }

.hidden {
  display: none; }

a.toc-backref {
  text-decoration: none;
  color: #444444; }

blockquote.epigraph {
  margin: 2em 5em; }

dl.docutils dd {
  margin-bottom: 0.5em; }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden; }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/
div.abstract {
  margin: 2em 5em; }

div.abstract p.topic-title {
  font-weight: bold;
  text-align: center; }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em;
  border: medium outset;
  padding: 1em; }

div.note, div.warning {
  margin: 1.5em 0px;
  border: none; }

div.note p.admonition-title,
div.warning p.admonition-title {
  display: none; }

/* Clearfix
 * http://css-tricks.com/snippets/css/clear-fix/
 */
div.note:after,
div.warning:after {
  content: "";
  display: table;
  clear: both; }

div.note p:before,
div.warning p:before {
  display: block;
  float: left;
  font-size: 4em;
  line-height: 1em;
  margin-right: 20px;
  margin-left: 0em;
  margin-top: -10px;
  content: '\0270D';
  /*handwriting*/ }

div.warning p:before {
  content: '\026A0';
  /*warning*/ }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold;
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif; }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: #b30000;
  font-weight: bold;
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif; }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic; }

div.dedication p.topic-title {
  font-weight: bold;
  font-style: normal; }

div.figure {
  margin-left: 2em;
  margin-right: 2em; }

div.footer, div.header {
  clear: both;
  font-size: smaller; }

div.line-block {
  display: block;
  margin-top: 1em;
  margin-bottom: 1em; }

div.line-block div.line-block {
  margin-top: 0;
  margin-bottom: 0;
  margin-left: 1.5em; }

div.sidebar {
  margin: 0 0 0.5em 1em;
  border: medium outset;
  padding: 1em;
  background-color: rgba(252, 248, 244, 0.75);
  width: 40%;
  float: right;
  clear: right; }

div.sidebar p.rubric {
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif;
  font-size: medium; }

div.system-messages {
  margin: 5em; }

div.system-messages h1 {
  color: #b30000; }

div.system-message {
  border: medium outset;
  padding: 1em; }

div.system-message p.system-message-title {
  color: #b30000;
  font-weight: bold; }

div.topic {
  margin: 2em; }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em; }

h1.title {
  text-align: center; }

h2.subtitle {
  text-align: center; }

hr.docutils {
  width: 75%; }

img.align-left, .figure.align-left, object.align-left {
  clear: left;
  float: left;
  margin-right: 1em; }

img.align-right, .figure.align-right, object.align-right {
  clear: right;
  float: right;
  margin-left: 1em; }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto; }

.align-left {
  text-align: left; }

.align-center {
  clear: both;
  text-align: center; }

.align-right {
  text-align: right; }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit; }

/* div.align-center * { */
/*   text-align: left } */

ul.simple > li {
  margin-bottom: 0.5em }

ol.simple, ul.simple {
  margin-bottom: 1em; }

ol.arabic {
  list-style: decimal; }

ol.loweralpha {
  list-style: lower-alpha; }

ol.upperalpha {
  list-style: upper-alpha; }

ol.lowerroman {
  list-style: lower-roman; }

ol.upperroman {
  list-style: upper-roman; }

p.attribution {
  text-align: right;
  margin-left: 50%; }

p.caption {
  font-style: italic; }

p.credits {
  font-style: italic;
  font-size: smaller; }

p.label {
  white-space: nowrap; }

p.rubric {
  font-weight: bold;
  font-size: larger;
  color: maroon;
  text-align: center; }

p.sidebar-title {
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif;
  font-weight: bold;
  font-size: larger; }

p.sidebar-subtitle {
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif;
  font-weight: bold; }

p.topic-title {
  font-weight: bold; }

pre.address {
  margin-bottom: 0;
  margin-top: 0;
  font: inherit; }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em;
  margin-right: 2em; }

pre.code .ln {
  color: grey; }

/* line numbers */
pre.code, code {
  background-color: #eeeeee; }

pre.code .comment, code .comment {
  color: #5c6576; }

pre.code .keyword, code .keyword {
  color: #3B0D06;
  font-weight: bold; }

pre.code .literal.string, code .literal.string {
  color: #0c5404; }

pre.code .name.builtin, code .name.builtin {
  color: #352b84; }

pre.code .deleted, code .deleted {
  background-color: #DEB0A1; }

pre.code .inserted, code .inserted {
  background-color: #A3D289; }

span.classifier {
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif;
  font-style: oblique; }

span.classifier-delimiter {
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif;
  font-weight: bold; }

span.interpreted {
  font-family: "Helvetica Neue", "HelveticaNeue", "Raleway", Helvetica, Arial, sans-serif; }

span.option {
  white-space: nowrap; }

span.pre {
  white-space: pre; }

span.problematic {
  color: #b30000; }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80%; }

table.citation {
  border-left: solid 1px #666666;
  margin-left: 1px; }

table.docinfo {
  margin: 0em;
  margin-top: 2em;
  margin-bottom: 2em;
  font-family: "Raleway", "Helvetica Neue", "HelveticaNeue", Helvetica, Arial, sans-serif !important;
  color: #444444; }

table.docutils {
  margin-top: 0.5em;
  margin-bottom: 0.5em; }

table.footnote {
  border-left: solid 1px #2d2d2d;
  margin-left: 1px; }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em;
  padding-right: 0.5em;
  vertical-align: top; }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: 700;
  text-align: left;
  white-space: nowrap;
  padding-left: 0; }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100%; }

ul.auto-toc {
  list-style-type: none; }

span.DecNumber {
  color: #252dbe; }

span.BinNumber {
  color: #252dbe; }

span.HexNumber {
  color: #252dbe; }

span.OctNumber {
  color: #252dbe; }

span.FloatNumber {
  color: #252dbe; }

span.Identifier {
  color: #3b3b3b; }

span.Keyword {
  font-weight: 600;
  color: #5e8f60; }

span.StringLit {
  color: #a4255b; }

span.LongStringLit {
  color: #a4255b; }

span.CharLit {
  color: #a4255b; }

span.EscapeSequence {
  color: black; }

span.Operator {
  color: black; }

span.Punctuation {
  color: black; }

span.Comment, span.LongComment {
  font-style: italic;
  font-weight: 400;
  color: #484a86; }

span.RegularExpression {
  color: darkviolet; }

span.TagStart {
  color: darkviolet; }

span.TagEnd {
  color: darkviolet; }

span.Key {
  color: #252dbe; }

span.Value {
  color: #252dbe; }

span.RawData {
  color: #a4255b; }

span.Assembler {
  color: #252dbe; }

span.Preprocessor {
  color: #252dbe; }

span.Directive {
  color: #252dbe; }

span.Command, span.Rule, span.Hyperlink, span.Label, span.Reference,
span.Other {
  color: black; }

/* Pop type, const, proc, and iterator defs in nim def blocks */
dt pre > span.Identifier, dt pre > span.Operator {
  color: #155da4;
  font-weight: 700; }

dt pre > span.Identifier ~ span.Identifier, dt pre > span.Operator ~ span.Identifier {
  color: inherit;
  font-weight: inherit; }

dt pre > span.Operator ~ span.Identifier, dt pre > span.Operator ~ span.Operator {
  color: inherit;
  font-weight: inherit; }

/* Nim sprite for the footer (taken from main page favicon) */
.nim-sprite {
  display: inline-block;
  height: 12px;
  width: 12px;
  background-position: 0 0;
  background-size: 12px 12px;
  -webkit-filter: opacity(50%);
  background-repeat: no-repeat;
  background-image: url("data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA==");
  margin-bottom: -5px; }
</style>

</head>
<body>
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">Module asyncdispatch</h1>
    <div class="row">
  <div class="three columns">
  <ul class="simple simple-toc" id="toc-list">
<li><a class="reference" id="asyncdispatch_toc" href="#asyncdispatch">AsyncDispatch</a></li>
<ul class="simple"><li><a class="reference" id="asyncdispatch-asynchronous-procedures_toc" href="#asyncdispatch-asynchronous-procedures">Asynchronous procedures</a></li>
<li><a class="reference" id="asyncdispatch-discarding-futures_toc" href="#asyncdispatch-discarding-futures">Discarding futures</a></li>
<li><a class="reference" id="asyncdispatch-examples_toc" href="#asyncdispatch-examples">Examples</a></li>
<li><a class="reference" id="asyncdispatch-limitations-bugs_toc" href="#asyncdispatch-limitations-bugs">Limitations/Bugs</a></li>
</ul><li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
  <ul class="simple simple-toc-section">
    
  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#FutureBase"
    title="FutureBase = ref object of RootObj
  cb: proc ()
  finished: bool
  error*: ref Exception         ## Stored exception
  errorStackTrace*: string
  when not false:
      stackTrace: string       ## For debugging purposes only.
      id: int
      fromProc: string"><wbr />Future<wbr />Base</a></li>
  <li><a class="reference" href="#Future"
    title="Future[T] = ref object of FutureBase
  value: T                     ## Stored value"><wbr />Future</a></li>
  <li><a class="reference" href="#FutureVar"
    title="FutureVar[T] = distinct Future[T]"><wbr />Future<wbr />Var</a></li>
  <li><a class="reference" href="#FutureError"
    title="FutureError = object of Exception
  cause*: FutureBase"><wbr />Future<wbr />Error</a></li>
  <li><a class="reference" href="#CompletionKey"
    title="CompletionKey = ULONG_PTR"><wbr />Completion<wbr />Key</a></li>
  <li><a class="reference" href="#CompletionData"
    title="CompletionData = object
  fd*: AsyncFD
  cb*: proc (fd: AsyncFD; bytesTransferred: DWORD; errcode: OSErrorCode)
  cell*: ForeignCell"><wbr />Completion<wbr />Data</a></li>
  <li><a class="reference" href="#PDispatcher"
    title="PDispatcher = ref object of PDispatcherBase
  ioPort: Handle
  handles: HashSet[AsyncFD]"><wbr />PDispatcher</a></li>
  <li><a class="reference" href="#PCustomOverlapped"
    title="PCustomOverlapped = ref CustomOverlapped"><wbr />PCustom<wbr />Overlapped</a></li>
  <li><a class="reference" href="#AsyncFD"
    title="AsyncFD = distinct int"><wbr />Async<wbr />FD</a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#newFuture,string"
    title="newFuture[T](fromProc: string = &quot;unspecified&quot;): Future[T]"><wbr />new<wbr />Future</a></li>
  <li><a class="reference" href="#newFutureVar,string"
    title="newFutureVar[T](fromProc = &quot;unspecified&quot;): FutureVar[T]"><wbr />new<wbr />Future<wbr />Var</a></li>
  <li><a class="reference" href="#clean,FutureVar[T]"
    title="clean[T](future: FutureVar[T])"><wbr />clean</a></li>
  <li><a class="reference" href="#complete,Future[T],T"
    title="complete[T](future: Future[T]; val: T)"><wbr />complete</a></li>
  <li><a class="reference" href="#complete,Future[void]"
    title="complete(future: Future[void])"><wbr />complete</a></li>
  <li><a class="reference" href="#complete,FutureVar[T]"
    title="complete[T](future: FutureVar[T])"><wbr />complete</a></li>
  <li><a class="reference" href="#fail,Future[T],ref.Exception"
    title="fail[T](future: Future[T]; error: ref Exception)"><wbr />fail</a></li>
  <li><a class="reference" href="#callback=,FutureBase,proc)"
    title="callback=(future: FutureBase; cb: proc ())"><wbr />callback=</a></li>
  <li><a class="reference" href="#callback=,Future[T],proc(Future[T])"
    title="callback=[T](future: Future[T]; cb: proc (future: Future[T]))"><wbr />callback=</a></li>
  <li><a class="reference" href="#read,Future[T]"
    title="read[T](future: Future[T]): T"><wbr />read</a></li>
  <li><a class="reference" href="#readError,Future[T]"
    title="readError[T](future: Future[T]): ref Exception"><wbr />read<wbr />Error</a></li>
  <li><a class="reference" href="#mget,FutureVar[T]"
    title="mget[T](future: FutureVar[T]): var T"><wbr />mget</a></li>
  <li><a class="reference" href="#finished,Future[T]"
    title="finished[T](future: Future[T]): bool"><wbr />finished</a></li>
  <li><a class="reference" href="#failed,FutureBase"
    title="failed(future: FutureBase): bool"><wbr />failed</a></li>
  <li><a class="reference" href="#asyncCheck,Future[T]"
    title="asyncCheck[T](future: Future[T])"><wbr />async<wbr />Check</a></li>
  <li><a class="reference" href="#and,Future[T],Future[Y]"
    title="`and`[T, Y](fut1: Future[T]; fut2: Future[Y]): Future[void]"><wbr />`and`</a></li>
  <li><a class="reference" href="#or,Future[T],Future[Y]"
    title="`or`[T, Y](fut1: Future[T]; fut2: Future[Y]): Future[void]"><wbr />`or`</a></li>
  <li><a class="reference" href="#all,varargs[Future[T]]"
    title="all[T](futs: varargs[Future[T]]): auto"><wbr />all</a></li>
  <li><a class="reference" href="#==,AsyncFD,AsyncFD"
    title="`==`(x: AsyncFD; y: AsyncFD): bool"><wbr />`==`</a></li>
  <li><a class="reference" href="#newDispatcher,"
    title="newDispatcher(): PDispatcher"><wbr />new<wbr />Dispatcher</a></li>
  <li><a class="reference" href="#getGlobalDispatcher,"
    title="getGlobalDispatcher(): PDispatcher"><wbr />get<wbr />Global<wbr />Dispatcher</a></li>
  <li><a class="reference" href="#register,AsyncFD"
    title="register(fd: AsyncFD)"><wbr />register</a></li>
  <li><a class="reference" href="#poll,int"
    title="poll(timeout = 500)"><wbr />poll</a></li>
  <li><a class="reference" href="#connect,AsyncFD,string,Port"
    title="connect(socket: AsyncFD; address: string; port: Port; domain = nativesockets.AF_INET): Future[
    void]"><wbr />connect</a></li>
  <li><a class="reference" href="#recv,AsyncFD,int"
    title="recv(socket: AsyncFD; size: int; flags = {SafeDisconn}): Future[string]"><wbr />recv</a></li>
  <li><a class="reference" href="#recvInto,AsyncFD,cstring,int"
    title="recvInto(socket: AsyncFD; buf: cstring; size: int; flags = {SafeDisconn}): Future[int]"><wbr />recv<wbr />Into</a></li>
  <li><a class="reference" href="#send,AsyncFD,string"
    title="send(socket: AsyncFD; data: string; flags = {SafeDisconn}): Future[void]"><wbr />send</a></li>
  <li><a class="reference" href="#sendTo,AsyncFD,pointer,int,ptr.SockAddr,SockLen"
    title="sendTo(socket: AsyncFD; data: pointer; size: int; saddr: ptr SockAddr; saddrLen: SockLen;
       flags = {SafeDisconn}): Future[void]"><wbr />send<wbr />To</a></li>
  <li><a class="reference" href="#recvFromInto,AsyncFD,pointer,int,ptr.SockAddr,ptr.SockLen"
    title="recvFromInto(socket: AsyncFD; data: pointer; size: int; saddr: ptr SockAddr;
             saddrLen: ptr SockLen; flags = {SafeDisconn}): Future[int]"><wbr />recv<wbr />From<wbr />Into</a></li>
  <li><a class="reference" href="#acceptAddr,AsyncFD"
    title="acceptAddr(socket: AsyncFD; flags = {SafeDisconn}): Future[
    tuple[address: string, client: AsyncFD]]"><wbr />accept<wbr />Addr</a></li>
  <li><a class="reference" href="#newAsyncNativeSocket,cint,cint,cint"
    title="newAsyncNativeSocket(domain, sockType, protocol: cint): AsyncFD"><wbr />new<wbr />Async<wbr />Native<wbr />Socket</a></li>
  <li><a class="reference" href="#newAsyncNativeSocket,Domain,SockType,Protocol"
    title="newAsyncNativeSocket(domain: Domain = nativesockets.AF_INET;
                     sockType: SockType = SOCK_STREAM;
                     protocol: Protocol = IPPROTO_TCP): AsyncFD"><wbr />new<wbr />Async<wbr />Native<wbr />Socket</a></li>
  <li><a class="reference" href="#closeSocket,AsyncFD"
    title="closeSocket(socket: AsyncFD)"><wbr />close<wbr />Socket</a></li>
  <li><a class="reference" href="#unregister,AsyncFD"
    title="unregister(fd: AsyncFD)"><wbr />unregister</a></li>
  <li><a class="reference" href="#addRead,AsyncFD,Callback"
    title="addRead(fd: AsyncFD; cb: Callback)"><wbr />add<wbr />Read</a></li>
  <li><a class="reference" href="#addWrite,AsyncFD,Callback"
    title="addWrite(fd: AsyncFD; cb: Callback)"><wbr />add<wbr />Write</a></li>
  <li><a class="reference" href="#sleepAsync,int"
    title="sleepAsync(ms: int): Future[void]"><wbr />sleep<wbr />Async</a></li>
  <li><a class="reference" href="#withTimeout,Future[T],int"
    title="withTimeout[T](fut: Future[T]; timeout: int): Future[bool]"><wbr />with<wbr />Timeout</a></li>
  <li><a class="reference" href="#accept,AsyncFD"
    title="accept(socket: AsyncFD; flags = {SafeDisconn}): Future[AsyncFD]"><wbr />accept</a></li>
  <li><a class="reference" href="#recvLine,AsyncFD"
    title="recvLine(socket: AsyncFD): Future[string]"><wbr />recv<wbr />Line</a></li>
  <li><a class="reference" href="#callSoon,proc)"
    title="callSoon(cbproc: proc ())"><wbr />call<wbr />Soon</a></li>
  <li><a class="reference" href="#runForever,"
    title="runForever()"><wbr />run<wbr />Forever</a></li>
  <li><a class="reference" href="#waitFor,Future[T]"
    title="waitFor[T](fut: Future[T]): T"><wbr />wait<wbr />For</a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#16" id="66">Macros</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#async.m,stmt"
    title="async(prc: stmt): stmt"><wbr />async</a></li>

  </ul>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
  <p class="module-desc">
<h1><a class="toc-backref" id="asyncdispatch" href="#asyncdispatch">AsyncDispatch</a></h1><p>This module implements asynchronous IO. This includes a dispatcher, a <tt class="docutils literal"><span class="pre">Future</span></tt> type implementation, and an <tt class="docutils literal"><span class="pre">async</span></tt> macro which allows asynchronous code to be written in a synchronous style with the <tt class="docutils literal"><span class="pre">await</span></tt> keyword.</p>
<p>The dispatcher acts as a kind of event loop. You must call <tt class="docutils literal"><span class="pre">poll</span></tt> on it (or a function which does so for you such as <tt class="docutils literal"><span class="pre">waitFor</span></tt> or <tt class="docutils literal"><span class="pre">runForever</span></tt>) in order to poll for any outstanding events. The underlying implementation is based on epoll on Linux, IO Completion Ports on Windows and select on other operating systems.</p>
<p>The <tt class="docutils literal"><span class="pre">poll</span></tt> function will not, on its own, return any events. Instead an appropriate <tt class="docutils literal"><span class="pre">Future</span></tt> object will be completed. A <tt class="docutils literal"><span class="pre">Future</span></tt> is a type which holds a value which is not yet available, but which <em>may</em> be available in the future. You can check whether a future is finished by using the <tt class="docutils literal"><span class="pre">finished</span></tt> function. When a future is finished it means that either the value that it holds is now available or it holds an error instead. The latter situation occurs when the operation to complete a future fails with an exception. You can distinguish between the two situations with the <tt class="docutils literal"><span class="pre">failed</span></tt> function.</p>
<p>Future objects can also store a callback procedure which will be called automatically once the future completes.</p>
<p>Futures therefore can be thought of as an implementation of the proactor pattern. In this pattern you make a request for an action, and once that action is fulfilled a future is completed with the result of that action. Requests can be made by calling the appropriate functions. For example: calling the <tt class="docutils literal"><span class="pre">recv</span></tt> function will create a request for some data to be read from a socket. The future which the <tt class="docutils literal"><span class="pre">recv</span></tt> function returns will then complete once the requested amount of data is read <strong>or</strong> an exception occurs.</p>
<p>Code to read some data from a socket may look something like this:</p>
<blockquote><p><pre class = "listing"><span class="Keyword">var</span> <span class="Identifier">future</span> <span class="Operator">=</span> <span class="Identifier">socket</span><span class="Operator">.</span><span class="Identifier">recv</span><span class="Punctuation">(</span><span class="DecNumber">100</span><span class="Punctuation">)</span>
<span class="Identifier">future</span><span class="Operator">.</span><span class="Identifier">callback</span> <span class="Operator">=</span>
  <span class="Keyword">proc</span> <span class="Punctuation">(</span><span class="Punctuation">)</span> <span class="Operator">=</span>
    <span class="Identifier">echo</span><span class="Punctuation">(</span><span class="Identifier">future</span><span class="Operator">.</span><span class="Identifier">read</span><span class="Punctuation">)</span></pre></p></blockquote>
<p>All asynchronous functions returning a <tt class="docutils literal"><span class="pre">Future</span></tt> will not block. They will not however return immediately. An asynchronous function will have code which will be executed before an asynchronous request is made, in most cases this code sets up the request.</p>
<p>In the above example, the <tt class="docutils literal"><span class="pre">recv</span></tt> function will return a brand new <tt class="docutils literal"><span class="pre">Future</span></tt> instance once the request for data to be read from the socket is made. This <tt class="docutils literal"><span class="pre">Future</span></tt> instance will complete once the requested amount of data is read, in this case it is 100 bytes. The second line sets a callback on this future which will be called once the future completes. All the callback does is write the data stored in the future to <tt class="docutils literal"><span class="pre">stdout</span></tt>. The <tt class="docutils literal"><span class="pre">read</span></tt> function is used for this and it checks whether the future completes with an error for you (if it did it will simply raise the error), if there is no error however it returns the value of the future.</p>

<h2><a class="toc-backref" id="asyncdispatch-asynchronous-procedures" href="#asyncdispatch-asynchronous-procedures">Asynchronous procedures</a></h2><p>Asynchronous procedures remove the pain of working with callbacks. They do this by allowing you to write asynchronous code the same way as you would write synchronous code.</p>
<p>An asynchronous procedure is marked using the <tt class="docutils literal"><span class="pre">{.async.}</span></tt> pragma. When marking a procedure with the <tt class="docutils literal"><span class="pre">{.async.}</span></tt> pragma it must have a <tt class="docutils literal"><span class="pre">Future[T]</span></tt> return type or no return type at all. If you do not specify a return type then <tt class="docutils literal"><span class="pre">Future[void]</span></tt> is assumed.</p>
<p>Inside asynchronous procedures <tt class="docutils literal"><span class="pre">await</span></tt> can be used to call any procedures which return a <tt class="docutils literal"><span class="pre">Future</span></tt>; this includes asynchronous procedures. When a procedure is &quot;awaited&quot;, the asynchronous procedure it is awaited in will suspend its execution until the awaited procedure's Future completes. At which point the asynchronous procedure will resume its execution. During the period when an asynchronous procedure is suspended other asynchronous procedures will be run by the dispatcher.</p>
<p>The <tt class="docutils literal"><span class="pre">await</span></tt> call may be used in many contexts. It can be used on the right hand side of a variable declaration: <tt class="docutils literal"><span class="pre">var data = await socket.recv(100)</span></tt>, in which case the variable will be set to the value of the future automatically. It can be used to await a <tt class="docutils literal"><span class="pre">Future</span></tt> object, and it can be used to await a procedure returning a <tt class="docutils literal"><span class="pre">Future[void]</span></tt>: <tt class="docutils literal"><span class="pre">await socket.send(&quot;foobar&quot;)</span></tt>.</p>

<h2><a class="toc-backref" id="asyncdispatch-discarding-futures" href="#asyncdispatch-discarding-futures">Discarding futures</a></h2><p>Futures should <strong>never</strong> be discarded. This is because they may contain errors. If you do not care for the result of a Future then you should use the <tt class="docutils literal"><span class="pre">asyncCheck</span></tt> procedure instead of the <tt class="docutils literal"><span class="pre">discard</span></tt> keyword.</p>

<h2><a class="toc-backref" id="asyncdispatch-examples" href="#asyncdispatch-examples">Examples</a></h2><p>For examples take a look at the documentation for the modules implementing asynchronous IO. A good place to start is the <a class="reference external" href="asyncnet.html">asyncnet module</a>.</p>

<h2><a class="toc-backref" id="asyncdispatch-limitations-bugs" href="#asyncdispatch-limitations-bugs">Limitations/Bugs</a></h2><ul class="simple"><li>The effect system (<tt class="docutils literal"><span class="pre">raises: []</span></tt>) does not work with async procedures.</li>
<li>Can't await in a <tt class="docutils literal"><span class="pre">except</span></tt> body</li>
<li>Forward declarations for async procs are broken, link includes workaround: <a class="reference external" href="https://github.com/nim-lang/Nim/issues/3182">https://github.com/nim-lang/Nim/issues/3182</a>.</li>
<li>FutureVar[T] needs to be completed manually.</li>
</ul>
</p>
  <div class="section" id="6">
<h1><a class="toc-backref" href="#6">Imports</a></h1>
<dl class="item">
<a class="reference external" href="os.html">os</a>, <a class="reference external" href="oids.html">oids</a>, <a class="reference external" href="tables.html">tables</a>, <a class="reference external" href="strutils.html">strutils</a>, <a class="reference external" href="macros.html">macros</a>, <a class="reference external" href="times.html">times</a>, <a class="reference external" href="heapqueue.html">heapqueue</a>, <a class="reference external" href="nativesockets.html">nativesockets</a>, <a class="reference external" href="net.html">net</a>, <a class="reference external" href="queues.html">queues</a>, <a class="reference external" href="winlean.html">winlean</a>, <a class="reference external" href="sets.html">sets</a>, <a class="reference external" href="hashes.html">hashes</a>
</dl></div>
<div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<dt id="FutureBase"><a name="FutureBase"></a><pre><span class="Identifier">FutureBase</span> <span class="Other">=</span> <span class="Keyword">ref</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">RootObj</span>
  <span class="Identifier">cb</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">closure</span><span class="Other">,</span> <span class="Identifier">gcsafe</span><span class="Other">.}</span>
  <span class="Identifier">finished</span><span class="Other">:</span> <span class="Identifier">bool</span>
  <span class="Identifier">error</span><span class="Operator">*</span><span class="Other">:</span> <span class="Keyword">ref</span> <span class="Identifier">Exception</span>         <span class="Comment">## Stored exception</span>
  <span class="Identifier">errorStackTrace</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Keyword">when</span> <span class="Keyword">not</span> <span class="DecNumber">false</span><span class="Other">:</span>
      <span class="Identifier">stackTrace</span><span class="Other">:</span> <span class="Identifier">string</span>       <span class="Comment">## For debugging purposes only.</span>
      <span class="Identifier">id</span><span class="Other">:</span> <span class="Identifier">int</span>
      <span class="Identifier">fromProc</span><span class="Other">:</span> <span class="Identifier">string</span>

  </pre></dt>
<dd>
Untyped future.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L136"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="Future"><a name="Future"></a><pre><span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">ref</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">FutureBase</span>
  <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">T</span>                     <span class="Comment">## Stored value</span>
  </pre></dt>
<dd>
Typed future.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L146"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="FutureVar"><a name="FutureVar"></a><pre><span class="Identifier">FutureVar</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">distinct</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span></pre></dt>
<dd>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L149"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="FutureError"><a name="FutureError"></a><pre><span class="Identifier">FutureError</span> <span class="Other">=</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">Exception</span>
  <span class="Identifier">cause</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">FutureBase</span>
</pre></dt>
<dd>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L151"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="CompletionKey"><a name="CompletionKey"></a><pre><span class="Identifier">CompletionKey</span> <span class="Other">=</span> <span class="Identifier">ULONG_PTR</span></pre></dt>
<dd>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L431"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="CompletionData"><a name="CompletionData"></a><pre><span class="Identifier">CompletionData</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">fd</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span>
  <span class="Identifier">cb</span><span class="Operator">*</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">fd</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">bytesTransferred</span><span class="Other">:</span> <span class="Identifier">DWORD</span><span class="Other">;</span> <span class="Identifier">errcode</span><span class="Other">:</span> <span class="Identifier">OSErrorCode</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">closure</span><span class="Other">,</span>
      <span class="Identifier">gcsafe</span><span class="Other">.}</span>
  <span class="Identifier">cell</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">ForeignCell</span>
</pre></dt>
<dd>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L433"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="PDispatcher"><a name="PDispatcher"></a><pre><span class="Identifier">PDispatcher</span> <span class="Other">=</span> <span class="Keyword">ref</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">PDispatcherBase</span>
  <span class="Identifier">ioPort</span><span class="Other">:</span> <span class="Identifier">Handle</span>
  <span class="Identifier">handles</span><span class="Other">:</span> <span class="Identifier">HashSet</span><span class="Other">[</span><span class="Identifier">AsyncFD</span><span class="Other">]</span>
</pre></dt>
<dd>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L441"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="PCustomOverlapped"><a name="PCustomOverlapped"></a><pre><span class="Identifier">PCustomOverlapped</span> <span class="Other">=</span> <span class="Keyword">ref</span> <span class="Identifier">CustomOverlapped</span></pre></dt>
<dd>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L448"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="AsyncFD"><a name="AsyncFD"></a><pre><span class="Identifier">AsyncFD</span> <span class="Other">=</span> <span class="Keyword">distinct</span> <span class="Identifier">int</span></pre></dt>
<dd>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L450"
class="link-seesrc" target="_blank">Source</a>
</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<dt id="newFuture"><a name="newFuture,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">newFuture</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">fromProc</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Other">=</span> <span class="StringLit">&quot;unspecified&quot;</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span></pre></dt>
<dd>
<p>Creates a new future.</p>
<p>Specifying <tt class="docutils literal"><span class="pre">fromProc</span></tt>, which is a string specifying the name of the proc that this future belongs to, is a good habit as it helps with debugging.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L161"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="newFutureVar"><a name="newFutureVar,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">newFutureVar</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">fromProc</span> <span class="Other">=</span> <span class="StringLit">&quot;unspecified&quot;</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">FutureVar</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span></pre></dt>
<dd>
<p>Create a new <tt class="docutils literal"><span class="pre">FutureVar</span></tt>. This Future type is ideally suited for situations where you want to avoid unnecessary allocations of Futures.</p>
<p>Specifying <tt class="docutils literal"><span class="pre">fromProc</span></tt>, which is a string specifying the name of the proc that this future belongs to, is a good habit as it helps with debugging.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L174"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="clean"><a name="clean,FutureVar[T]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">clean</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">FutureVar</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
<dd>
Resets the <tt class="docutils literal"><span class="pre">finished</span></tt> status of <tt class="docutils literal"><span class="pre">future</span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L182"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="complete"><a name="complete,Future[T],T"></a><pre><span class="Keyword">proc</span> <span class="Identifier">complete</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">T</span><span class="Other">)</span></pre></dt>
<dd>
Completes <tt class="docutils literal"><span class="pre">future</span></tt> with value <tt class="docutils literal"><span class="pre">val</span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L208"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="complete"><a name="complete,Future[void]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">complete</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">void</span><span class="Other">]</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">FutureError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
                                   <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Completes a void <tt class="docutils literal"><span class="pre">future</span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L218"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="complete"><a name="complete,FutureVar[T]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">complete</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">FutureVar</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
<dd>
Completes a <tt class="docutils literal"><span class="pre">FutureVar</span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L227"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="fail"><a name="fail,Future[T],ref.Exception"></a><pre><span class="Keyword">proc</span> <span class="Identifier">fail</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">error</span><span class="Other">:</span> <span class="Keyword">ref</span> <span class="Identifier">Exception</span><span class="Other">)</span></pre></dt>
<dd>
Completes <tt class="docutils literal"><span class="pre">future</span></tt> with <tt class="docutils literal"><span class="pre">error</span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L236"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="callback="><a name="callback=,FutureBase,proc)"></a><pre><span class="Keyword">proc</span> <span class="Identifier">callback=</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">FutureBase</span><span class="Other">;</span> <span class="Identifier">cb</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">closure</span><span class="Other">,</span> <span class="Identifier">gcsafe</span><span class="Other">.}</span><span class="Other">)</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Sets the callback proc to be called when the future completes.</p>
<p>If future has already completed then <tt class="docutils literal"><span class="pre">cb</span></tt> will be called immediately.</p>
<p><strong>Note</strong>: You most likely want the other <tt class="docutils literal"><span class="pre">callback</span></tt> setter which passes <tt class="docutils literal"><span class="pre">future</span></tt> as a param to the callback.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L254"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="callback="><a name="callback=,Future[T],proc(Future[T])"></a><pre><span class="Keyword">proc</span> <span class="Identifier">callback=</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span>
                 <span class="Identifier">cb</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">closure</span><span class="Other">,</span> <span class="Identifier">gcsafe</span><span class="Other">.}</span><span class="Other">)</span></pre></dt>
<dd>
<p>Sets the callback proc to be called when the future completes.</p>
<p>If future has already completed then <tt class="docutils literal"><span class="pre">cb</span></tt> will be called immediately.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L265"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="read"><a name="read,Future[T]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">read</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">T</span></pre></dt>
<dd>
<p>Retrieves the value of <tt class="docutils literal"><span class="pre">future</span></tt>. Future must be finished otherwise this function will fail with a <tt class="docutils literal"><span class="pre">ValueError</span></tt> exception.</p>
<p>If the result of the future is an error then that error will be raised.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L284"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="readError"><a name="readError,Future[T]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">readError</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">ref</span> <span class="Identifier">Exception</span></pre></dt>
<dd>
<p>Retrieves the exception stored in <tt class="docutils literal"><span class="pre">future</span></tt>.</p>
<p>An <tt class="docutils literal"><span class="pre">ValueError</span></tt> exception will be thrown if no exception exists in the specified Future.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L299"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="mget"><a name="mget,FutureVar[T]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">mget</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">FutureVar</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">T</span></pre></dt>
<dd>
<p>Returns a mutable value stored in <tt class="docutils literal"><span class="pre">future</span></tt>.</p>
<p>Unlike <tt class="docutils literal"><span class="pre">read</span></tt>, this function will not raise an exception if the Future has not been finished.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L308"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="finished"><a name="finished,Future[T]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">finished</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
<dd>
<p>Determines whether <tt class="docutils literal"><span class="pre">future</span></tt> has completed.</p>
<p><tt class="docutils literal"><span class="pre">True</span></tt> may indicate an error or a value. Use <tt class="docutils literal"><span class="pre">failed</span></tt> to distinguish.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L315"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="failed"><a name="failed,FutureBase"></a><pre><span class="Keyword">proc</span> <span class="Identifier">failed</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">FutureBase</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Determines whether <tt class="docutils literal"><span class="pre">future</span></tt> completed with an error.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L321"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="asyncCheck"><a name="asyncCheck,Future[T]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">asyncCheck</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">future</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
<dd>
<p>Sets a callback on <tt class="docutils literal"><span class="pre">future</span></tt> which raises an exception if the future finished with an error.</p>
<p>This should be used instead of <tt class="docutils literal"><span class="pre">discard</span></tt> to discard void futures.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L325"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="and"><a name="and,Future[T],Future[Y]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">`and`</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">,</span> <span class="Identifier">Y</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">fut1</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">fut2</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">Y</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">void</span><span class="Other">]</span></pre></dt>
<dd>
Returns a future which will complete once both <tt class="docutils literal"><span class="pre">fut1</span></tt> and <tt class="docutils literal"><span class="pre">fut2</span></tt> complete.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L336"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="or"><a name="or,Future[T],Future[Y]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">`or`</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">,</span> <span class="Identifier">Y</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">fut1</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">fut2</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">Y</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">void</span><span class="Other">]</span></pre></dt>
<dd>
Returns a future which will complete once either <tt class="docutils literal"><span class="pre">fut1</span></tt> or <tt class="docutils literal"><span class="pre">fut2</span></tt> complete.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L348"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="all"><a name="all,varargs[Future[T]]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">all</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">futs</span><span class="Other">:</span> <span class="Identifier">varargs</span><span class="Other">[</span><span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">auto</span></pre></dt>
<dd>
<p>Returns a future which will complete once all futures in <tt class="docutils literal"><span class="pre">futs</span></tt> complete.</p>
<p>If the awaited futures are not <tt class="docutils literal"><span class="pre">Future[void]</span></tt>, the returned future will hold the values of all awaited futures in a sequence.</p>
<p>If the awaited futures <em>are</em> <tt class="docutils literal"><span class="pre">Future[void]</span></tt>, this proc returns <tt class="docutils literal"><span class="pre">Future[void]</span></tt>.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L358"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="=="><a name="==,AsyncFD,AsyncFD"></a><pre><span class="Keyword">proc</span> <span class="Identifier">`==`</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">y</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">{.</span><span class="Identifier">borrow</span><span class="Other">.}</span></pre></dt>
<dd>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L464"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="newDispatcher"><a name="newDispatcher,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">newDispatcher</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">PDispatcher</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Creates a new Dispatcher instance.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L466"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="getGlobalDispatcher"><a name="getGlobalDispatcher,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">getGlobalDispatcher</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">PDispatcher</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Retrieves the global thread-local dispatcher.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L475"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="register"><a name="register,AsyncFD"></a><pre><span class="Keyword">proc</span> <span class="Identifier">register</span><span class="Other">(</span><span class="Identifier">fd</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Registers <tt class="docutils literal"><span class="pre">fd</span></tt> with the dispatcher.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L480"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="poll"><a name="poll,int"></a><pre><span class="Keyword">proc</span> <span class="Identifier">poll</span><span class="Other">(</span><span class="Identifier">timeout</span> <span class="Other">=</span> <span class="DecNumber">500</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">,</span>
                               <span class="Identifier">IndexError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">TimeEffect</span><span class="Other">,</span> <span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Waits for completion events and processes them.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L496"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="connect"><a name="connect,AsyncFD,string,Port"></a><pre><span class="Keyword">proc</span> <span class="Identifier">connect</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">address</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">port</span><span class="Other">:</span> <span class="Identifier">Port</span><span class="Other">;</span>
            <span class="Identifier">domain</span> <span class="Other">=</span> <span class="Identifier">nativesockets</span><span class="Other">.</span><span class="Identifier">AF_INET</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">void</span><span class="Other">]</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Connects <tt class="docutils literal"><span class="pre">socket</span></tt> to server at <tt class="docutils literal"><span class="pre">address:port</span></tt>.</p>
<p>Returns a <tt class="docutils literal"><span class="pre">Future</span></tt> which will complete when the connection succeeds or an error occurs.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L616"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="recv"><a name="recv,AsyncFD,int"></a><pre><span class="Keyword">proc</span> <span class="Identifier">recv</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Reads <strong>up to</strong> <tt class="docutils literal"><span class="pre">size</span></tt> bytes from <tt class="docutils literal"><span class="pre">socket</span></tt>. Returned future will complete once all the data requested is read, a part of the data has been read, or the socket has disconnected in which case the future will complete with a value of <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>.</p>
<p><strong>Warning</strong>: The <tt class="docutils literal"><span class="pre">Peek</span></tt> socket flag is not supported on Windows.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L678"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="recvInto"><a name="recvInto,AsyncFD,cstring,int"></a><pre><span class="Keyword">proc</span> <span class="Identifier">recvInto</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">buf</span><span class="Other">:</span> <span class="Identifier">cstring</span><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Reads <strong>up to</strong> <tt class="docutils literal"><span class="pre">size</span></tt> bytes from <tt class="docutils literal"><span class="pre">socket</span></tt> into <tt class="docutils literal"><span class="pre">buf</span></tt>, which must at least be of that size. Returned future will complete once all the data requested is read, a part of the data has been read, or the socket has disconnected in which case the future will complete with a value of <tt class="docutils literal"><span class="pre">0</span></tt>.</p>
<p><strong>Warning</strong>: The <tt class="docutils literal"><span class="pre">Peek</span></tt> socket flag is not supported on Windows.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L752"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="send"><a name="send,AsyncFD,string"></a><pre><span class="Keyword">proc</span> <span class="Identifier">send</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">void</span><span class="Other">]</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Sends <tt class="docutils literal"><span class="pre">data</span></tt> to <tt class="docutils literal"><span class="pre">socket</span></tt>. The returned future will complete once all data has been sent.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L822"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="sendTo"><a name="sendTo,AsyncFD,pointer,int,ptr.SockAddr,SockLen"></a><pre><span class="Keyword">proc</span> <span class="Identifier">sendTo</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">saddr</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">SockAddr</span><span class="Other">;</span>
           <span class="Identifier">saddrLen</span><span class="Other">:</span> <span class="Identifier">SockLen</span><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">void</span><span class="Other">]</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Sends <tt class="docutils literal"><span class="pre">data</span></tt> to specified destination <tt class="docutils literal"><span class="pre">saddr</span></tt>, using socket <tt class="docutils literal"><span class="pre">socket</span></tt>. The returned future will complete once all data has been sent.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L865"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="recvFromInto"><a name="recvFromInto,AsyncFD,pointer,int,ptr.SockAddr,ptr.SockLen"></a><pre><span class="Keyword">proc</span> <span class="Identifier">recvFromInto</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">saddr</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">SockAddr</span><span class="Other">;</span>
                 <span class="Identifier">saddrLen</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">SockLen</span><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Receives a datagram data from <tt class="docutils literal"><span class="pre">socket</span></tt> into <tt class="docutils literal"><span class="pre">buf</span></tt>, which must be at least of size <tt class="docutils literal"><span class="pre">size</span></tt>, address of datagram's sender will be stored into <tt class="docutils literal"><span class="pre">saddr</span></tt> and <tt class="docutils literal"><span class="pre">saddrLen</span></tt>. Returned future will complete once one datagram has been received, and will return size of packet received.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L911"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="acceptAddr"><a name="acceptAddr,AsyncFD"></a><pre><span class="Keyword">proc</span> <span class="Identifier">acceptAddr</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span>
    <span class="Keyword">tuple</span><span class="Other">[</span><span class="Identifier">address</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">,</span> <span class="Identifier">client</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">]</span><span class="Other">]</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Accepts a new connection. Returns a future containing the client socket corresponding to that connection and the remote address of the client. The future will complete when the connection is successfully accepted.</p>
<p>The resulting client socket is automatically registered to the dispatcher.</p>
<p>The <tt class="docutils literal"><span class="pre">accept</span></tt> call may result in an error if the connecting socket disconnects during the duration of the <tt class="docutils literal"><span class="pre">accept</span></tt>. If the <tt class="docutils literal"><span class="pre">SafeDisconn</span></tt> flag is specified then this error will not be raised and instead accept will be called again.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L960"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="newAsyncNativeSocket"><a name="newAsyncNativeSocket,cint,cint,cint"></a><pre><span class="Keyword">proc</span> <span class="Identifier">newAsyncNativeSocket</span><span class="Other">(</span><span class="Identifier">domain</span><span class="Other">,</span> <span class="Identifier">sockType</span><span class="Other">,</span> <span class="Identifier">protocol</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Creates a new socket and registers it with the dispatcher implicitly.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1049"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="newAsyncNativeSocket"><a name="newAsyncNativeSocket,Domain,SockType,Protocol"></a><pre><span class="Keyword">proc</span> <span class="Identifier">newAsyncNativeSocket</span><span class="Other">(</span><span class="Identifier">domain</span><span class="Other">:</span> <span class="Identifier">Domain</span> <span class="Other">=</span> <span class="Identifier">nativesockets</span><span class="Other">.</span><span class="Identifier">AF_INET</span><span class="Other">;</span>
                         <span class="Identifier">sockType</span><span class="Other">:</span> <span class="Identifier">SockType</span> <span class="Other">=</span> <span class="Identifier">SOCK_STREAM</span><span class="Other">;</span>
                         <span class="Identifier">protocol</span><span class="Other">:</span> <span class="Identifier">Protocol</span> <span class="Other">=</span> <span class="Identifier">IPPROTO_TCP</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Creates a new socket and registers it with the dispatcher implicitly.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1055"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="closeSocket"><a name="closeSocket,AsyncFD"></a><pre><span class="Keyword">proc</span> <span class="Identifier">closeSocket</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Closes a socket and ensures that it is unregistered.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1063"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="unregister"><a name="unregister,AsyncFD"></a><pre><span class="Keyword">proc</span> <span class="Identifier">unregister</span><span class="Other">(</span><span class="Identifier">fd</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Unregisters <tt class="docutils literal"><span class="pre">fd</span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1068"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="addRead"><a name="addRead,AsyncFD,Callback"></a><pre><span class="Keyword">proc</span> <span class="Identifier">addRead</span><span class="Other">(</span><span class="Identifier">fd</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">cb</span><span class="Other">:</span> <span class="Identifier">Callback</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
                                     <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Start watching the file descriptor for read availability and then call the callback <tt class="docutils literal"><span class="pre">cb</span></tt>.</p>
<p>This is not <tt class="docutils literal"><span class="pre">pure</span></tt> mechanism for Windows Completion Ports (IOCP), so if you can avoid it, please do it. Use <cite>addRead</cite> only if really need it (main usecase is adaptation of <cite>unix like</cite> libraries to be asynchronous on Windows). If you use this function, you dont need to use asyncdispatch.recv() or asyncdispatch.accept(), because they are using IOCP, please use nativesockets.recv() and nativesockets.accept() instead.</p>
<p>Be sure your callback <tt class="docutils literal"><span class="pre">cb</span></tt> returns <tt class="docutils literal"><span class="pre">true</span></tt>, if you want to remove watch of <cite>read</cite> notifications, and <tt class="docutils literal"><span class="pre">false</span></tt>, if you want to continue receiving notifies.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1158"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="addWrite"><a name="addWrite,AsyncFD,Callback"></a><pre><span class="Keyword">proc</span> <span class="Identifier">addWrite</span><span class="Other">(</span><span class="Identifier">fd</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">cb</span><span class="Other">:</span> <span class="Identifier">Callback</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
                                      <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Start watching the file descriptor for write availability and then call the callback <tt class="docutils literal"><span class="pre">cb</span></tt>.</p>
<p>This is not <tt class="docutils literal"><span class="pre">pure</span></tt> mechanism for Windows Completion Ports (IOCP), so if you can avoid it, please do it. Use <cite>addWrite</cite> only if really need it (main usecase is adaptation of <cite>unix like</cite> libraries to be asynchronous on Windows). If you use this function, you dont need to use asyncdispatch.send() or asyncdispatch.connect(), because they are using IOCP, please use nativesockets.send() and nativesockets.connect() instead.</p>
<p>Be sure your callback <tt class="docutils literal"><span class="pre">cb</span></tt> returns <tt class="docutils literal"><span class="pre">true</span></tt>, if you want to remove watch of <cite>write</cite> notifications, and <tt class="docutils literal"><span class="pre">false</span></tt>, if you want to continue receiving notifies.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1175"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="sleepAsync"><a name="sleepAsync,int"></a><pre><span class="Keyword">proc</span> <span class="Identifier">sleepAsync</span><span class="Other">(</span><span class="Identifier">ms</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">void</span><span class="Other">]</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">TimeEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Suspends the execution of the current async procedure for the next <tt class="docutils literal"><span class="pre">ms</span></tt> milliseconds.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1537"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="withTimeout"><a name="withTimeout,Future[T],int"></a><pre><span class="Keyword">proc</span> <span class="Identifier">withTimeout</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">fut</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">timeout</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">bool</span><span class="Other">]</span></pre></dt>
<dd>
<p>Returns a future which will complete once <tt class="docutils literal"><span class="pre">fut</span></tt> completes or after <tt class="docutils literal"><span class="pre">timeout</span></tt> milliseconds has elapsed.</p>
<p>If <tt class="docutils literal"><span class="pre">fut</span></tt> completes first the returned future will hold true, otherwise, if <tt class="docutils literal"><span class="pre">timeout</span></tt> milliseconds has elapsed first, the returned future will hold false.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1545"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="accept"><a name="accept,AsyncFD"></a><pre><span class="Keyword">proc</span> <span class="Identifier">accept</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">AsyncFD</span><span class="Other">]</span> <span class="Other">{.</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Accepts a new connection. Returns a future containing the client socket corresponding to that connection. The future will complete when the connection is successfully accepted.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1563"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="recvLine"><a name="recvLine,AsyncFD"></a><pre><span class="Keyword">proc</span> <span class="Identifier">recvLine</span><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <span class="Identifier">AsyncFD</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">FutureError</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
<p>Reads a line of data from <tt class="docutils literal"><span class="pre">socket</span></tt>. Returned future will complete once a full line is read or an error occurs.</p>
<p>If a full line is read <tt class="docutils literal"><span class="pre">\r\L</span></tt> is not added to <tt class="docutils literal"><span class="pre">line</span></tt>, however if solely <tt class="docutils literal"><span class="pre">\r\L</span></tt> is read then <tt class="docutils literal"><span class="pre">line</span></tt> will be set to it.</p>
<p>If the socket is disconnected, <tt class="docutils literal"><span class="pre">line</span></tt> will be set to <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>.</p>
<p>If the socket is disconnected in the middle of a line (before <tt class="docutils literal"><span class="pre">\r\L</span></tt> is read) then line will be set to <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>. The partial line <strong>will be lost</strong>.</p>
<p><strong>Warning</strong>: This assumes that lines are delimited by <tt class="docutils literal"><span class="pre">\r\L</span></tt>.</p>
<p><strong>Note</strong>: This procedure is mostly used for testing. You likely want to use <tt class="docutils literal"><span class="pre">asyncnet.recvLine</span></tt> instead.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1935"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="callSoon"><a name="callSoon,proc)"></a><pre><span class="Keyword">proc</span> <span class="Identifier">callSoon</span><span class="Other">(</span><span class="Identifier">cbproc</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Other">)</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Schedule <cite>cbproc</cite> to be called as soon as possible. The callback is called when control returns to the event loop.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1974"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="runForever"><a name="runForever,"></a><pre><span class="Keyword">proc</span> <span class="Identifier">runForever</span><span class="Other">(</span><span class="Other">)</span> <span class="Other">{.</span><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">FutureError</span><span class="Other">,</span> <span class="Identifier">IndexError</span><span class="Other">]</span><span class="Other">,</span>
                  <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">TimeEffect</span><span class="Other">,</span> <span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">.}</span></pre></dt>
<dd>
Begins a never ending global dispatcher poll loop.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1979"
class="link-seesrc" target="_blank">Source</a>
</dd>
<dt id="waitFor"><a name="waitFor,Future[T]"></a><pre><span class="Keyword">proc</span> <span class="Identifier">waitFor</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">fut</span><span class="Other">:</span> <span class="Identifier">Future</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">T</span></pre></dt>
<dd>
<strong>Blocks</strong> the current thread until the specified future completes.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1984"
class="link-seesrc" target="_blank">Source</a>
</dd>

</dl></div>
<div class="section" id="16">
<h1><a class="toc-backref" href="#16">Macros</a></h1>
<dl class="item">
<dt id="async"><a name="async.m,stmt"></a><pre><span class="Keyword">macro</span> <span class="Identifier">async</span><span class="Other">(</span><span class="Identifier">prc</span><span class="Other">:</span> <span class="Identifier">stmt</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">stmt</span> <span class="Other">{.</span><span class="Identifier">immediate</span><span class="Other">.}</span></pre></dt>
<dd>
Macro which processes async procedures into the appropriate iterators and yield statements.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/master/lib/pure/asyncdispatch.nim#L1925"
class="link-seesrc" target="_blank">Source</a>
</dd>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small>Made with Nim. Generated: 2016-06-29 14:24:02 UTC</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
